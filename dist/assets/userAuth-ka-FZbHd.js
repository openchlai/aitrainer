import{_,r as u,c as p,a,t as m,w as f,v as c,b,d as h,u as T,o as g}from"./index-B0RH2Ixy.js";import{a as v}from"./axios-DVlZSSgf.js";const q={setup(){const i=u(""),t=u(""),d=u(""),e=u(!1),l=u(!1),y=T(),s=()=>{e.value=!e.value,l.value=!1,i.value="",t.value="",d.value=""},R=async()=>{var o,n;try{const r=await v.post("/auth/register/",{whatsapp_number:i.value,name:t.value});alert(r.data.message),e.value=!1}catch(r){alert(((n=(o=r.response)==null?void 0:o.data)==null?void 0:n.error)||"Registration failed.")}},w=async()=>{var o,n;try{const r=await v.post("/auth/request-otp/",{whatsapp_number:i.value});alert(r.data.message),l.value=!0}catch(r){alert(((n=(o=r.response)==null?void 0:o.data)==null?void 0:n.error)||"Failed to request OTP.")}};return{whatsapp_number:i,name:t,otp:d,isRegister:e,otpRequested:l,toggleMode:s,registerUser:R,verifyOTP:async()=>{var o,n;if(!l.value)return w();try{const r=await v.post("/auth/verify-otp/",{whatsapp_number:i.value,otp:d.value});alert("OTP Verified! Login successful."),localStorage.setItem("access_token",r.data.access),localStorage.setItem("refresh_token",r.data.refresh),y.push("/dashboard")}catch(r){alert(((n=(o=r.response)==null?void 0:o.data)==null?void 0:n.error)||"OTP verification failed.")}}}}},O={class:"container"},P={class:"form-group"},k={key:0,class:"form-group"},x={key:1,class:"form-group"},V={type:"submit"};function M(i,t,d,e,l,y){return g(),p("div",O,[a("h2",null,m(e.isRegister?"Register":"Login"),1),a("form",{onSubmit:t[3]||(t[3]=h(s=>e.isRegister?e.registerUser():e.verifyOTP(),["prevent"]))},[a("div",P,[t[5]||(t[5]=a("label",{for:"whatsapp_number"},"WhatsApp Number",-1)),f(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>e.whatsapp_number=s),required:""},null,512),[[c,e.whatsapp_number]])]),e.isRegister?(g(),p("div",k,[t[6]||(t[6]=a("label",{for:"name"},"Name",-1)),f(a("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>e.name=s),required:""},null,512),[[c,e.name]])])):b("",!0),e.otpRequested?(g(),p("div",x,[t[7]||(t[7]=a("label",null,"OTP",-1)),f(a("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>e.otp=s),required:""},null,512),[[c,e.otp]])])):b("",!0),a("button",V,m(e.isRegister?"Register":e.otpRequested?"Verify OTP":"Request OTP"),1)],32),a("button",{onClick:t[4]||(t[4]=(...s)=>e.toggleMode&&e.toggleMode(...s))},m(e.isRegister?"Already have an account? Login":"New user? Register"),1)])}const A=_(q,[["render",M],["__scopeId","data-v-1a1ce2ca"]]);export{A as default};
