import{_ as I,u as B,r as i,m as D,c as v,w as f,a as E,b as o,t as r,n as $,p as L,k as h,o as M,q as k}from"./index-COiIlx8B.js";import{u as R}from"./caseStore-CwzcL8jD.js";const V={class:"audio-screen"},j={class:"top-bar"},F={class:"audio-container"},Y=["src"],z={class:"playback-buttons"},G=["disabled"],H=["disabled"],J={class:"current-time"},K={class:"action-buttons"},O=["disabled"],Q=["disabled"],U={__name:"AudioScreen",setup(W){const c=B(),A=R(),_=L(),s=i(0),a=i(null),n=i(!1),p=i(0),y=i(!1),m=i(null);D(()=>{console.log(_.params.startIndex);const e=parseInt(_.params.startIndex,10);console.log(e),s.value=Number.isNaN(e)?0:e});const d=v(()=>A.audioList),t=v(()=>d.value[s.value]||{}),b=v(()=>d.value.length);console.log("Current Audio:",t.value),console.log("audioList:",d.value.length);const C=v(()=>t.value.audio_file?(console.log(t.value.audio_file),t.value.audio_file):"");f(t,async()=>{n.value=!1,p.value=0,await k(),a.value&&a.value.load()}),f(a,e=>{e&&(e.ontimeupdate=()=>{p.value=e.currentTime},e.onplay=()=>{n.value=!0},e.onpause=()=>{n.value=!1},e.onloadedmetadata=()=>{t.value&&(t.value.duration=e.duration)})});function x(){a.value&&a.value.play()}function w(){a.value&&a.value.pause()}function T(){a.value&&(a.value.currentTime=0,n.value=!1,a.value.pause())}function g(e){if(!a.value)return;const u=a.value.duration;if(!u||isNaN(u))return;let l=a.value.currentTime+e;l=Math.min(Math.max(l,0),u),a.value.currentTime=l}f(y,async e=>{e&&(await k(),m.value&&m.value.focus())});async function N(){if(console.log(t.value),!!t.value.unique_id)try{const e=await h.patch(`/transcriptions/cleaned-audio-files/${t.value.unique_id}/approve/`);console.log(e.data.message),t.value.is_evaluated=!0,c.success("Audio successfully approved and chunked!")}catch(e){console.error("Error saving transcription:",e),c.error("Could not save transcription.")}}async function P(){if(t.value.unique_id)try{const e=await h.patch(`/transcriptions/cleaned-audio-files/${t.value.unique_id}/disapprove/`);console.log(e.data.message),t.value.is_evaluated=!1,c.success("Audio Disapproved.")}catch(e){console.error("Error disapproving audio:",e),c.error("Could not disapporve audio.")}}function S(){s.value<d.value.length-1&&s.value++}function q(){s.value>0&&s.value--}return(e,u)=>(M(),E("div",V,[o("div",j,[o("p",null,r(s.value+1)+" / "+r(b.value),1),o("h2",null," Evaluating Audio "+r(s.value),1)]),o("div",F,[o("audio",{ref_key:"audioPlayer",ref:a,class:"audio-player",controls:""},[o("source",{src:C.value,type:"audio/wav"},null,8,Y),u[2]||(u[2]=$(" Your browser does not support the audio element. "))],512),o("div",z,[o("button",{onClick:x,disabled:n.value},"Play",8,G),o("button",{onClick:w,disabled:!n.value},"Pause",8,H),o("button",{onClick:T},"Reset"),o("button",{onClick:u[0]||(u[0]=l=>g(-5))},"-5s"),o("button",{onClick:u[1]||(u[1]=l=>g(5))},"+5s")]),o("div",J," Time: "+r(p.value.toFixed(2))+"s / "+r(t.value.duration||0)+"s ",1)]),o("div",K,[o("button",{onClick:q,disabled:s.value===0}," Previous ",8,O),o("button",{onClick:P,class:"reject-button"}," Disapprove "),o("button",{onClick:N,class:"save-button"}," Approve "),o("button",{onClick:S,disabled:s.value===b.value-1}," Next ",8,Q)])]))}},ee=I(U,[["__scopeId","data-v-5c56d35a"]]);export{ee as default};
