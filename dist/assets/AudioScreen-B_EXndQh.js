import{_ as q,u as B,s as D,r as i,n as E,c as v,w as f,a as $,b as o,t as r,x as L,y as M,o as R,z as h}from"./index-6pGkwk_o.js";import{a as k}from"./axios-CPsZO0Op.js";const V={class:"audio-screen"},j={class:"top-bar"},z={class:"audio-container"},F=["src"],Y={class:"playback-buttons"},G=["disabled"],H=["disabled"],J={class:"current-time"},K={class:"action-buttons"},O=["disabled"],Q=["disabled"],U={__name:"AudioScreen",setup(W){const c=B(),A=D(),_=M(),s=i(0),a=i(null),n=i(!1),p=i(0),y=i(!1),b=i(null);E(()=>{console.log(_.params.startIndex);const e=parseInt(_.params.startIndex,10);console.log(e),s.value=Number.isNaN(e)?0:e});const d=v(()=>A.audioList),t=v(()=>d.value[s.value]||{}),m=v(()=>d.value.length);console.log("Current Audio:",t.value),console.log("audioList:",d.value.length);const x=v(()=>t.value.audio_file?(console.log(t.value.audio_file),t.value.audio_file):"");f(t,async()=>{n.value=!1,p.value=0,await h(),a.value&&a.value.load()}),f(a,e=>{e&&(e.ontimeupdate=()=>{p.value=e.currentTime},e.onplay=()=>{n.value=!0},e.onpause=()=>{n.value=!1},e.onloadedmetadata=()=>{t.value&&(t.value.duration=e.duration)})});function C(){a.value&&a.value.play()}function w(){a.value&&a.value.pause()}function T(){a.value&&(a.value.currentTime=0,n.value=!1,a.value.pause())}function g(e){if(!a.value)return;const u=a.value.duration;if(!u||isNaN(u))return;let l=a.value.currentTime+e;l=Math.min(Math.max(l,0),u),a.value.currentTime=l}f(y,async e=>{e&&(await h(),b.value&&b.value.focus())});async function N(){if(console.log(t.value),!!t.value.unique_id)try{const e=await k.patch(`/transcriptions/cleaned-audio-files/${t.value.unique_id}/approve/`);console.log(e.data.message),t.value.is_evaluated=!0,c.success("Audio successfully approved and chunked!")}catch(e){console.error("Error saving transcription:",e),c.error("Could not save transcription.")}}async function P(){if(t.value.unique_id)try{const e=await k.patch(`/transcriptions/cleaned-audio-files/${t.value.unique_id}/disapprove/`);console.log(e.data.message),t.value.is_evaluated=!1,c.success("Audio Disapproved.")}catch(e){console.error("Error disapproving audio:",e),c.error("Could not disapporve audio.")}}function S(){s.value<d.value.length-1&&s.value++}function I(){s.value>0&&s.value--}return(e,u)=>(R(),$("div",V,[o("div",j,[o("p",null,r(s.value+1)+" / "+r(m.value),1),o("h2",null," Evaluating Audio "+r(s.value),1)]),o("div",z,[o("audio",{ref_key:"audioPlayer",ref:a,class:"audio-player",controls:""},[o("source",{src:x.value,type:"audio/wav"},null,8,F),u[2]||(u[2]=L(" Your browser does not support the audio element. "))],512),o("div",Y,[o("button",{onClick:C,disabled:n.value},"Play",8,G),o("button",{onClick:w,disabled:!n.value},"Pause",8,H),o("button",{onClick:T},"Reset"),o("button",{onClick:u[0]||(u[0]=l=>g(-5))},"-5s"),o("button",{onClick:u[1]||(u[1]=l=>g(5))},"+5s")]),o("div",J," Time: "+r(p.value.toFixed(2))+"s / "+r(t.value.duration||0)+"s ",1)]),o("div",K,[o("button",{onClick:I,disabled:s.value===0}," Previous ",8,O),o("button",{onClick:P,class:"reject-button"}," Disapprove "),o("button",{onClick:N,class:"save-button"}," Approve "),o("button",{onClick:S,disabled:s.value===m.value-1}," Next ",8,Q)])]))}},ee=q(U,[["__scopeId","data-v-c5fe463f"]]);export{ee as default};
