import{_ as w,B as R,m as V,r as c,h as I,n as k,g,c as U,a,t as p,p as i,w as d,C as v,q as B,s as D,o as M,x as L}from"./index-B0RH2Ixy.js";const A={class:"audio-screen"},q={class:"top-bar"},F={class:"audio-container"},O=["src"],Y={class:"playback-buttons"},j=["disabled"],z=["disabled"],G={class:"current-time"},H={class:"evaluation-box"},J={class:"action-buttons"},K=["disabled"],Q=["disabled"],W="http://127.0.0.1:8000",X={__name:"ChunkEvalScreen",setup(Z){const f=R(),C=V(),x=B(),u=c(0),l=c(null),r=c(!1),_=c(0),t=c({single_speaker:!1,speaker_overlap:!1,background_noise:!1,prolonged_silence:!1,Not_Speech_Rate:!1,echo_noise:!1});I(()=>{const s=parseInt(x.params.startIndex,10);u.value=Number.isNaN(s)?0:s});const b=k(()=>C.audioList),n=k(()=>b.value[u.value]||{}),m=k(()=>b.value.length),y=k(()=>n.value.chunk_file?n.value.chunk_file:"");g(n,async()=>{r.value=!1,_.value=0,t.value={single_speaker:!1,speaker_overlap:!1,background_noise:!1,prolonged_silence:!1,Not_Speech_Rate:!1,echo_noise:!1},await L(),l.value&&l.value.load()}),g(l,s=>{s&&(s.ontimeupdate=()=>{_.value=s.currentTime},s.onplay=()=>{r.value=!0},s.onpause=()=>{r.value=!1})});function S(){l.value&&l.value.play()}function N(){l.value&&l.value.pause()}function E(){l.value&&(l.value.currentTime=0,r.value=!1,l.value.pause())}function h(s){if(!l.value)return;const e=l.value.currentTime+s,o=l.value.duration||0;l.value.currentTime=Math.min(Math.max(e,0),o)}async function P(){if(!n.value.id)return;const s={...t.value,is_evaluated:!0};try{const e=await D.post(`${W}/api/transcriptions/evaluate-chunk/${n.value.id}/`,s);e.data.created?f.success(`Chunk ${n.value.id} saved successfully! Evaluation ID: ${e.data.evaluation_id}`):f.success(`Chunk ${n.value.id} updated successfully! Evaluation ID: ${e.data.evaluation_id}`)}catch(e){console.error("Error saving evaluation:",e),f.error(`Could not save evaluation for chunk ${n.value.id}. Please try again.`)}}function T(){u.value<b.value.length-1&&u.value++}function $(){u.value>0&&u.value--}return(s,e)=>(M(),U("div",A,[a("div",q,[a("p",null,p(u.value+1)+" / "+p(m.value),1),a("h2",null,"Evaluating Chunk "+p(n.value.id),1)]),a("div",F,[a("audio",{ref_key:"audioPlayer",ref:l,class:"audio-player",controls:""},[a("source",{src:y.value,type:"audio/wav"},null,8,O),e[8]||(e[8]=i(" Your browser does not support the audio element. "))],512),a("div",Y,[a("button",{onClick:S,disabled:r.value},"Play",8,j),a("button",{onClick:N,disabled:!r.value},"Pause",8,z),a("button",{onClick:E},"Reset"),a("button",{onClick:e[0]||(e[0]=o=>h(-5))},"-5s"),a("button",{onClick:e[1]||(e[1]=o=>h(5))},"+5s")]),a("div",G," Time: "+p(_.value.toFixed(2))+"s / "+p(n.value.duration||0)+"s ",1)]),a("div",H,[a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>t.value.single_speaker=o)},null,512),[[v,t.value.single_speaker]]),e[9]||(e[9]=i(" Single Speaker "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>t.value.speaker_overlap=o)},null,512),[[v,t.value.speaker_overlap]]),e[10]||(e[10]=i(" Speaker Overlap "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>t.value.background_noise=o)},null,512),[[v,t.value.background_noise]]),e[11]||(e[11]=i(" Background Noise "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>t.value.prolonged_silence=o)},null,512),[[v,t.value.prolonged_silence]]),e[12]||(e[12]=i(" Prolonged Silence "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=o=>t.value.Not_Speech_Rate=o)},null,512),[[v,t.value.Not_Speech_Rate]]),e[13]||(e[13]=i(" Not Speech Rate "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=o=>t.value.echo_noise=o)},null,512),[[v,t.value.echo_noise]]),e[14]||(e[14]=i(" Echo Noise "))])]),a("div",J,[a("button",{onClick:$,disabled:u.value===0},"Previous",8,K),a("button",{onClick:P,class:"save-button"},"Save Evaluation"),a("button",{onClick:T,disabled:u.value===m.value-1},"Next",8,Q)])]))}},ae=w(X,[["__scopeId","data-v-1a6f727c"]]);export{ae as default};
