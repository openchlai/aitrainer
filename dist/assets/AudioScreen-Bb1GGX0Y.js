import{_ as D,u as I,A as q,r as i,n as E,c as v,w as f,a as $,b as o,t as r,B as L,C as M,o as R,D as h}from"./index-BubFmXFG.js";import{a as A}from"./axios-CgEV6GP0.js";const V={class:"audio-screen"},j={class:"top-bar"},F={class:"audio-container"},Y=["src"],z={class:"playback-buttons"},G=["disabled"],H=["disabled"],J={class:"current-time"},K={class:"action-buttons"},O=["disabled"],Q=["disabled"],U={__name:"AudioScreen",setup(W){const c=I(),k=q(),_=M(),s=i(0),a=i(null),n=i(!1),p=i(0),C=i(!1),b=i(null);E(()=>{console.log(_.params.startIndex);const e=parseInt(_.params.startIndex,10);console.log(e),s.value=Number.isNaN(e)?0:e});const d=v(()=>k.audioList),t=v(()=>d.value[s.value]||{}),m=v(()=>d.value.length);console.log("Current Audio:",t.value),console.log("audioList:",d.value.length);const y=v(()=>t.value.audio_file?(console.log(t.value.audio_file),t.value.audio_file):"");f(t,async()=>{n.value=!1,p.value=0,await h(),a.value&&a.value.load()}),f(a,e=>{e&&(e.ontimeupdate=()=>{p.value=e.currentTime},e.onplay=()=>{n.value=!0},e.onpause=()=>{n.value=!1},e.onloadedmetadata=()=>{t.value&&(t.value.duration=e.duration)})});function x(){a.value&&a.value.play()}function w(){a.value&&a.value.pause()}function T(){a.value&&(a.value.currentTime=0,n.value=!1,a.value.pause())}function g(e){if(!a.value)return;const u=a.value.duration;if(!u||isNaN(u))return;let l=a.value.currentTime+e;l=Math.min(Math.max(l,0),u),a.value.currentTime=l}f(C,async e=>{e&&(await h(),b.value&&b.value.focus())});async function N(){if(console.log(t.value),!!t.value.unique_id)try{const e=await A.patch(`/transcriptions/cleaned-audio-files/${t.value.unique_id}/approve/`);console.log(e.data.message),t.value.is_evaluated=!0,c.success("Audio successfully approved and chunked!")}catch(e){console.error("Error saving transcription:",e),c.error("Could not save transcription.")}}async function P(){if(t.value.unique_id)try{const e=await A.patch(`/transcriptions/cleaned-audio-files/${t.value.unique_id}/disapprove/`);console.log(e.data.message),t.value.is_evaluated=!1,c.success("Audio Disapproved.")}catch(e){console.error("Error disapproving audio:",e),c.error("Could not disapporve audio.")}}function S(){s.value<d.value.length-1&&s.value++}function B(){s.value>0&&s.value--}return(e,u)=>(R(),$("div",V,[o("div",j,[o("p",null,r(s.value+1)+" / "+r(m.value),1),o("h2",null," Evaluating Audio "+r(s.value),1)]),o("div",F,[o("audio",{ref_key:"audioPlayer",ref:a,class:"audio-player",controls:""},[o("source",{src:y.value,type:"audio/wav"},null,8,Y),u[2]||(u[2]=L(" Your browser does not support the audio element. "))],512),o("div",z,[o("button",{onClick:x,disabled:n.value},"Play",8,G),o("button",{onClick:w,disabled:!n.value},"Pause",8,H),o("button",{onClick:T},"Reset"),o("button",{onClick:u[0]||(u[0]=l=>g(-5))},"-5s"),o("button",{onClick:u[1]||(u[1]=l=>g(5))},"+5s")]),o("div",J," Time: "+r(p.value.toFixed(2))+"s / "+r(t.value.duration||0)+"s ",1)]),o("div",K,[o("button",{onClick:B,disabled:s.value===0}," Previous ",8,O),o("button",{onClick:P,class:"reject-button"}," Disapprove "),o("button",{onClick:N,class:"save-button"}," Approve "),o("button",{onClick:S,disabled:s.value===m.value-1}," Next ",8,Q)])]))}},ee=D(U,[["__scopeId","data-v-c5fe463f"]]);export{ee as default};
