import{_ as T,r as c,w as k,n as A,o as d,a as p,b as t,F as h,y as L,t as f,C as F,d as R,f as $,h as m,K as y,E as q,g as P,k as V}from"./index-BtTokaJG.js";const B={class:"container"},D={class:"request-list"},E={class:"request-header"},M={class:"request-title"},N=["onClick"],I={key:0,class:"transcription-container"},j={class:"transcription-title"},K=["src"],O={class:"audio-controls"},S=["disabled"],Y=["disabled"],z={class:"audio-navigation"},G={class:"current-time"},H={__name:"TranscriptionList",setup(v){const o=c([]),u=c(null),n=c(""),a=c(null),r=c(!1),i=c(0),_=async()=>{try{const s=await y.get("http://127.0.0.1:8000/api/transcription/case-records");o.value=s.data}catch(s){console.error("Error fetching transcription requests:",s)}},C=s=>{u.value=s,n.value="",i.value=0,r.value=!1},x=()=>{a.value&&(a.value.play(),r.value=!0)},g=()=>{a.value&&(a.value.pause(),r.value=!1)},U=()=>{a.value&&(a.value.currentTime=0,r.value=!1,n.value="")},b=s=>{if(a.value){const e=a.value.currentTime+s,l=a.value.duration||0;a.value.currentTime=Math.min(Math.max(e,0),l)}};k(a,s=>{s&&(s.ontimeupdate=()=>{i.value=s.currentTime})}),k(()=>{var s,e;return(e=(s=u.value)==null?void 0:s.audio_file)==null?void 0:e.audio_file},async(s,e)=>{a.value&&s&&e&&s!==e&&(await q(),a.value.load())});const w=()=>{console.log("Submitting transcription:",n.value)};return A(_),(s,e)=>(d(),p("div",B,[e[6]||(e[6]=t("h1",{class:"title"},"Transcription Requests",-1)),t("ul",D,[(d(!0),p(h,null,L(o.value,l=>(d(),p("li",{key:l.audio_file.unique_id,class:"request-item"},[t("div",E,[t("span",M,f(l.case_id)+" - "+f(l.narrative),1),t("button",{onClick:st=>C(l),class:"transcribe-button"},"Transcribe",8,N)])]))),128))]),u.value?(d(),p("div",I,[t("h2",j,"Transcribing Case: "+f(u.value.case_id),1),t("audio",{ref_key:"audioPlayer",ref:a,controls:"",class:"audio-player"},[(d(),p("source",{key:u.value.audio_file.audio_file,src:`http://localhost:8000${u.value.audio_file.audio_file}`,type:"audio/wav"},null,8,K)),e[5]||(e[5]=F(" Your browser does not support the audio element. "))],512),t("div",O,[t("button",{onClick:x,disabled:r.value,class:"play-button"},"Play",8,S),t("button",{onClick:g,disabled:!r.value,class:"pause-button"},"Pause",8,Y),t("button",{onClick:U,class:"reset-button"},"Reset")]),t("div",z,[t("button",{onClick:e[0]||(e[0]=l=>b(-10)),class:"skip-button"},"-10s"),t("button",{onClick:e[1]||(e[1]=l=>b(-5)),class:"skip-button"},"-5s"),t("button",{onClick:e[2]||(e[2]=l=>b(5)),class:"skip-button"},"+5s"),t("button",{onClick:e[3]||(e[3]=l=>b(10)),class:"skip-button"},"+10s")]),R(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>n.value=l),class:"transcription-textarea",rows:"6",placeholder:"Enter transcription here..."},null,512),[[$,n.value]]),t("p",G," Current Time: "+f(i.value.toFixed(2))+" seconds ",1),t("button",{onClick:w,class:"transcribe-button"}," Submit Transcription ")])):m("",!0)]))}},J=T(H,[["__scopeId","data-v-e2147ef0"]]),Q={components:{TranscriptionList:J},setup(){const v=c(null),o=c(""),u=c("");return{audioFile:v,audioURL:o,transcript:u,handleFileUpload:async r=>{const i=r.target.files[0];i&&(o.value=URL.createObjectURL(i),v.value=i)},transcribeAudio:async()=>{if(!v.value){alert("Please upload an audio file.");return}const r=new FormData;r.append("audio_file",v.value);try{const i=await y.post("http://127.0.0.1:8000/api/transcription/transcribe/",r,{headers:{"Content-Type":"multipart/form-data"}});u.value=i.data.model_transcript}catch(i){console.error("Transcription failed:",i)}}}}},W={class:"container"},X={key:0},Z=["src"],tt={key:1};function et(v,o,u,n,a,r){const i=V("TranscriptionList");return d(),p(h,null,[P(i),t("div",W,[o[3]||(o[3]=t("h2",null,"Upload & Transcribe Audio",-1)),t("input",{type:"file",onChange:o[0]||(o[0]=(..._)=>n.handleFileUpload&&n.handleFileUpload(..._)),accept:"audio/*"},null,32),n.audioURL?(d(),p("div",X,[t("audio",{src:n.audioURL,controls:""},null,8,Z),t("button",{onClick:o[1]||(o[1]=(..._)=>n.transcribeAudio&&n.transcribeAudio(..._))},"Transcribe")])):m("",!0),n.transcript?(d(),p("div",tt,[o[2]||(o[2]=t("h3",null,"Transcription",-1)),t("p",null,f(n.transcript),1)])):m("",!0)])],64)}const nt=T(Q,[["render",et],["__scopeId","data-v-5198f122"]]);export{nt as default};
