import{_ as S,u as I,B,r as l,n as D,c as d,w as p,a as E,b as t,t as r,C as M,d as K,f as L,L as V,i as R,D as $,o as q,E as g}from"./index-BtTokaJG.js";import{a as F}from"./axios-C_WwstY2.js";const U={class:"audio-screen"},Y={class:"top-bar"},j={class:"audio-container"},z=["src"],G={class:"playback-buttons"},H=["disabled"],J=["disabled"],O={class:"current-time"},Q={class:"transcription-box"},W={class:"action-buttons"},X=["disabled"],Z=["disabled"],ee={__name:"TranscribingScreen",setup(te){const f=I(),k=B(),b=$(),n=l(0),o=l(null),u=l(!1),v=l(0),T=l(!1),_=l(null);D(()=>{console.log(b.params.startIndex);const e=parseInt(b.params.startIndex,10);console.log(e),n.value=Number.isNaN(e)?0:e});const c=d(()=>k.audioList),s=d(()=>c.value[n.value]||{}),m=d(()=>c.value.length);console.log("Current Audio:",s.value),console.log("audioList:",c.value.length);const y=d(()=>s.value.chunk_file?(console.log(s.value.chunk_file),s.value.chunk_file):"");p(s,async()=>{u.value=!1,v.value=0,await g(),o.value&&o.value.load()}),p(o,e=>{e&&(e.ontimeupdate=()=>{v.value=e.currentTime},e.onplay=()=>{u.value=!0},e.onpause=()=>{u.value=!1},e.onloadedmetadata=()=>{s.value&&(s.value.duration=e.duration)})});function w(){o.value&&o.value.play()}function x(){o.value&&o.value.pause()}function C(){o.value&&(o.value.currentTime=0,u.value=!1,o.value.pause())}function h(e){if(!o.value)return;const a=o.value.duration;if(!a||isNaN(a))return;let i=o.value.currentTime+e;i=Math.min(Math.max(i,0),a),o.value.currentTime=i}p(T,async e=>{e&&(await g(),_.value&&_.value.focus())});async function A(){if(console.log(s.value),!!s.value.unique_id)try{const e=await F.patch("/transcriptions/tbd/");console.log(e.data.message),s.value.is_evaluated=!0,f.success("Audio successfully approved and chunked!")}catch(e){console.error("Error saving transcription:",e),f.error("Could not save transcription.")}}function N(){n.value<c.value.length-1&&n.value++}function P(){n.value>0&&n.value--}return(e,a)=>(q(),E("div",U,[t("div",Y,[t("p",null,r(n.value+1)+" / "+r(m.value),1),t("h2",null," Transcribing Chunk "+r(n.value),1)]),t("div",j,[t("audio",{ref_key:"audioPlayer",ref:o,class:"audio-player",controls:""},[t("source",{src:y.value,type:"audio/wav"},null,8,z),a[4]||(a[4]=M(" Your browser does not support the audio element. "))],512),t("div",G,[t("button",{onClick:w,disabled:u.value},"Play",8,H),t("button",{onClick:x,disabled:!u.value},"Pause",8,J),t("button",{onClick:C},"Reset"),t("button",{onClick:a[0]||(a[0]=i=>h(-5))},"-5s"),t("button",{onClick:a[1]||(a[1]=i=>h(5))},"+5s")]),t("div",O," Time: "+r(v.value.toFixed(2))+"s / "+r(s.value.duration||0)+"s ",1)]),t("div",Q,[a[5]||(a[5]=t("label",{for:"transcription"},"Transcription:",-1)),K(t("textarea",{id:"transcription",ref:"transcriptionInput","onUpdate:modelValue":a[2]||(a[2]=i=>e.transcriptionText=i),rows:"5",onKeydown:a[3]||(a[3]=V(R((...i)=>e.handleEnterKey&&e.handleEnterKey(...i),["prevent"]),["enter"]))},null,544),[[L,e.transcriptionText]])]),t("div",W,[t("button",{onClick:P,disabled:n.value===0}," Previous ",8,X),t("button",{onClick:A,class:"save-button"}," Save "),t("button",{onClick:N,disabled:n.value===m.value-1}," Next ",8,Z)])]))}},se=S(ee,[["__scopeId","data-v-86011862"]]);export{se as default};
