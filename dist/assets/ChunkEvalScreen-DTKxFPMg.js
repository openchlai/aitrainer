import{_ as V,C as $,q as R,r as c,m as I,c as k,w as h,a as U,b as a,t as p,s as i,d,D as v,x as D,o as B,z as M}from"./index-BsEMERiD.js";import{a as L}from"./axios-CU2zWRgY.js";const q={class:"audio-screen"},z={class:"top-bar"},F={class:"audio-container"},O=["src"],Y={class:"playback-buttons"},j=["disabled"],A=["disabled"],G={class:"current-time"},H={class:"evaluation-box"},J={class:"action-buttons"},K=["disabled"],Q=["disabled"],W={__name:"ChunkEvalScreen",setup(X){const f=$(),C=R(),y=D(),u=c(0),l=c(null),r=c(!1),b=c(0),t=c({single_speaker:!1,speaker_overlap:!1,background_noise:!1,prolonged_silence:!1,Not_Speech_Rate:!1,echo_noise:!1});I(()=>{const n=parseInt(y.params.startIndex,10);u.value=Number.isNaN(n)?0:n});const _=k(()=>C.audioList),s=k(()=>_.value[u.value]||{}),m=k(()=>_.value.length),x=k(()=>s.value.chunk_file?s.value.chunk_file:"");h(s,async()=>{r.value=!1,b.value=0,t.value={single_speaker:!1,speaker_overlap:!1,background_noise:!1,prolonged_silence:!1,Not_Speech_Rate:!1,echo_noise:!1},await M(),l.value&&l.value.load()}),h(l,n=>{n&&(n.ontimeupdate=()=>{b.value=n.currentTime},n.onplay=()=>{r.value=!0},n.onpause=()=>{r.value=!1})});function S(){l.value&&l.value.play()}function N(){l.value&&l.value.pause()}function E(){l.value&&(l.value.currentTime=0,r.value=!1,l.value.pause())}function g(n){if(!l.value)return;const e=l.value.currentTime+n,o=l.value.duration||0;l.value.currentTime=Math.min(Math.max(e,0),o)}async function T(){if(!s.value.id)return;const n={...t.value,is_evaluated:!0};try{const e=await L.post(`/transcriptions/evaluate-chunk/${s.value.id}/`,n);e.data.created?f.success(`Chunk ${s.value.id} saved successfully! Evaluation ID: ${e.data.evaluation_id}`):f.success(`Chunk ${s.value.id} updated successfully! Evaluation ID: ${e.data.evaluation_id}`)}catch(e){console.error("Error saving evaluation:",e),f.error(`Could not save evaluation for chunk ${s.value.id}. Please try again.`)}}function P(){u.value<_.value.length-1&&u.value++}function w(){u.value>0&&u.value--}return(n,e)=>(B(),U("div",q,[a("div",z,[a("p",null,p(u.value+1)+" / "+p(m.value),1),a("h2",null,"Evaluating Chunk "+p(s.value.id),1)]),a("div",F,[a("audio",{ref_key:"audioPlayer",ref:l,class:"audio-player",controls:""},[a("source",{src:x.value,type:"audio/wav"},null,8,O),e[8]||(e[8]=i(" Your browser does not support the audio element. "))],512),a("div",Y,[a("button",{onClick:S,disabled:r.value},"Play",8,j),a("button",{onClick:N,disabled:!r.value},"Pause",8,A),a("button",{onClick:E},"Reset"),a("button",{onClick:e[0]||(e[0]=o=>g(-5))},"-5s"),a("button",{onClick:e[1]||(e[1]=o=>g(5))},"+5s")]),a("div",G," Time: "+p(b.value.toFixed(2))+"s / "+p(s.value.duration||0)+"s ",1)]),a("div",H,[a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>t.value.single_speaker=o)},null,512),[[v,t.value.single_speaker]]),e[9]||(e[9]=i(" Single Speaker "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>t.value.speaker_overlap=o)},null,512),[[v,t.value.speaker_overlap]]),e[10]||(e[10]=i(" Speaker Overlap "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>t.value.background_noise=o)},null,512),[[v,t.value.background_noise]]),e[11]||(e[11]=i(" Background Noise "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>t.value.prolonged_silence=o)},null,512),[[v,t.value.prolonged_silence]]),e[12]||(e[12]=i(" Prolonged Silence "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=o=>t.value.Not_Speech_Rate=o)},null,512),[[v,t.value.Not_Speech_Rate]]),e[13]||(e[13]=i(" Not Speech Rate "))]),a("label",null,[d(a("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=o=>t.value.echo_noise=o)},null,512),[[v,t.value.echo_noise]]),e[14]||(e[14]=i(" Echo Noise "))])]),a("div",J,[a("button",{onClick:w,disabled:u.value===0},"Previous",8,K),a("button",{onClick:T,class:"save-button"},"Save Evaluation"),a("button",{onClick:P,disabled:u.value===m.value-1},"Next",8,Q)])]))}},ae=V(W,[["__scopeId","data-v-b649ad32"]]);export{ae as default};
